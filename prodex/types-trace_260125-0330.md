*Generated by [Prodex](https://github.com/emxhive/prodex#readme)*
> Note for LLMs: `Lx-Ly` ranges refer to lines in this Prodex trace file, not the original source files. Index metadata is provided via the HTML comment markers in this section.

# Index
<!-- PRODEX_INDEX_RANGE: L8-L67 -->
<!-- PRODEX_FILE_COUNT: 60 -->
<!-- PRODEX_INDEX_LIST_START -->
- [src/Types/Balance/ProviderBalance.php](#1)  L71-L112
- [src/Types/Bulk/BulkCreateOrderResult.php](#2)  L113-L155
- [src/Types/Bulk/BulkOrderStatusResult.php](#3)  L156-L198
- [src/Types/Contract/ContractQuote.php](#4)  L199-L254
- [src/Types/Contract/ContractQuoteRef.php](#5)  L255-L297
- [src/Types/Contract/ContractRef.php](#6)  L298-L340
- [src/Types/Contract/ContractStatus.php](#7)  L341-L395
- [src/Types/Contract/ContractStatusCode.php](#8)  L396-L433
- [src/Types/Currency.php](#9)  L434-L472
- [src/Types/DripFeed/DripFeedRef.php](#10)  L473-L514
- [src/Types/DripFeed/DripFeedStatus.php](#11)  L515-L558
- [src/Types/DripFeed/DripFeedStatusCode.php](#12)  L559-L582
- [src/Types/Driver/ConfigField.php](#13)  L583-L650
- [src/Types/Driver/ConfigFieldOption.php](#14)  L651-L701
- [src/Types/Driver/DriverConfigSchema.php](#15)  L702-L766
- [src/Types/Driver/DriverManifest.php](#16)  L767-L830
- [src/Types/Driver/ProviderInfo.php](#17)  L831-L879
- [src/Types/Infra/CapabilityMap.php](#18)  L880-L927
- [src/Types/Infra/HttpMethod.php](#19)  L928-L949
- [src/Types/Infra/IdempotencyKey.php](#20)  L950-L974
- [src/Types/Infra/ProviderRateLimit.php](#21)  L975-L1009
- [src/Types/Infra/ProviderRateLimitWindow.php](#22)  L1010-L1040
- [src/Types/Money.php](#23)  L1041-L1079
- [src/Types/Ops/AuditRecord.php](#24)  L1080-L1170
- [src/Types/Ops/HealthState.php](#25)  L1171-L1191
- [src/Types/Ops/WebhookEvent.php](#26)  L1192-L1232
- [src/Types/Ops/WebhookEventType.php](#27)  L1233-L1254
- [src/Types/Orders/OrderRef.php](#28)  L1255-L1298
- [src/Types/Orders/OrderStatus.php](#29)  L1299-L1348
- [src/Types/Orders/OrderStatusCode.php](#30)  L1349-L1376
- [src/Types/Refill/RefillRef.php](#31)  L1377-L1418
- [src/Types/Refill/RefillStatus.php](#32)  L1419-L1462
- [src/Types/Refill/RefillStatusCode.php](#33)  L1463-L1488
- [src/Types/Schema/ConstraintOverride.php](#34)  L1489-L1527
- [src/Types/Schema/Field.php](#35)  L1528-L1618
- [src/Types/Schema/FieldOption.php](#36)  L1619-L1666
- [src/Types/Schema/FlagKey.php](#37)  L1667-L1686
- [src/Types/Schema/ServiceFallback.php](#38)  L1687-L1730
- [src/Types/Schema/ServiceProps.php](#39)  L1731-L1786
- [src/Types/Schema/Tag.php](#40)  L1787-L1858
- [src/Types/Schema/Ui/UiAnyOf.php](#41)  L1859-L1895
- [src/Types/Schema/Ui/UiArray.php](#42)  L1896-L1943
- [src/Types/Schema/Ui/UiBoolean.php](#43)  L1944-L1968
- [src/Types/Schema/Ui/UiNode.php](#44)  L1969-L1989
- [src/Types/Schema/Ui/UiNumber.php](#45)  L1990-L2025
- [src/Types/Schema/Ui/UiObject.php](#46)  L2026-L2071
- [src/Types/Schema/Ui/UiString.php](#47)  L2072-L2114
- [src/Types/Service/OperationKey.php](#48)  L2115-L2163
- [src/Types/Service/ServiceDefinition.php](#49)  L2164-L2221
- [src/Types/Service/ServiceEstimates.php](#50)  L2222-L2267
- [src/Types/Service/ServiceField.php](#51)  L2268-L2316
- [src/Types/Service/ServiceFieldRule.php](#52)  L2317-L2359
- [src/Types/Service/ServiceFlag.php](#53)  L2360-L2404
- [src/Types/Service/ServiceFlagset.php](#54)  L2405-L2511
- [src/Types/Service/ServiceInputSchema.php](#55)  L2512-L2556
- [src/Types/Service/SpeedEstimate.php](#56)  L2557-L2610
- [src/Types/Service/TimeRangeEstimate.php](#57)  L2611-L2661
- [src/Types/Subscription/SubscriptionRef.php](#58)  L2662-L2703
- [src/Types/Subscription/SubscriptionStatus.php](#59)  L2704-L2749
- [src/Types/Subscription/SubscriptionStatusCode.php](#60)  L2750-L2776
<!-- PRODEX_INDEX_LIST_END -->

---
---
#### 1


` File: src/Types/Balance/ProviderBalance.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Balance;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;

final readonly class ProviderBalance implements Arrayable, JsonSerializable
{
    /**
     * @param array<string, mixed>|null $meta
     */
    public function __construct(
        public float   $balance,      // provider native number
        public ?string $currency = null,
        public ?array  $meta = null,
    ) {}

    public function toArray(): array
    {
        return array_filter([
            'balance' => $this->balance,
            'currency' => $this->currency,
            'meta' => $this->meta,
        ], static fn ($v) => $v !== null);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 2


` File: src/Types/Bulk/BulkCreateOrderResult.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Bulk;

use JsonSerializable;
use Dgp\Sdk\Support\DgpError;
use Dgp\Sdk\Support\Serialization\Arrayable;
use Dgp\Sdk\Types\Orders\OrderRef;

final readonly class BulkCreateOrderResult implements Arrayable, JsonSerializable
{
    public function __construct(
        public int       $index,
        public bool      $ok,
        public ?OrderRef $order = null,
        public ?DgpError $error = null,
    ) {}

    public function toArray(): array
    {
        return array_filter([
            'index' => $this->index,
            'ok' => $this->ok,
            'order' => $this->order?->toArray(),
            'error' => $this->error?->toArray(),
        ], static fn ($v) => $v !== null);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 3


` File: src/Types/Bulk/BulkOrderStatusResult.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Bulk;

use JsonSerializable;
use Dgp\Sdk\Support\DgpError;
use Dgp\Sdk\Support\Serialization\Arrayable;
use Dgp\Sdk\Types\Orders\OrderStatus;

final readonly class BulkOrderStatusResult implements Arrayable, JsonSerializable
{
    public function __construct(
        public string       $providerOrderId,
        public bool         $ok,
        public ?OrderStatus $status = null,
        public ?DgpError    $error = null,
    ) {}

    public function toArray(): array
    {
        return array_filter([
            'provider_order_id' => $this->providerOrderId,
            'ok' => $this->ok,
            'status' => $this->status?->toArray(),
            'error' => $this->error?->toArray(),
        ], static fn ($v) => $v !== null);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 4


` File: src/Types/Contract/ContractQuote.php`  [↑ Back to top](#index)

```php
<?php declare(strict_types=1);

namespace Dgp\Sdk\Types\Contract;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;
use Dgp\Sdk\Support\Serialization\Normalizes;

final readonly class ContractQuote implements Arrayable, JsonSerializable
{
    use Normalizes;

    /**
     * @param array<string,mixed>|null $meta
     * @param list<string>|null $warnings
     */
    public function __construct(
        public ContractQuoteRef $quote,
        public string|int       $service_id,

        public ?float           $estimated_total = null,     // provider-centric; host can convert to Money
        public ?string          $currency = null,           // optional hint (host may ignore)
        public ?string          $expires_at = null,         // ISO string (optional)
        public ?array           $warnings = null,            // non-fatal warnings
        public ?array           $meta = null,
    )
    {
    }

    public function toArray(): array
    {
        return $this->normalize([
            'quote' => $this->quote,
            'service_id' => $this->service_id,
            'estimated_total' => $this->estimated_total,
            'currency' => $this->currency,
            'expires_at' => $this->expires_at,
            'warnings' => $this->warnings,
            'meta' => $this->meta,
        ]);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 5


` File: src/Types/Contract/ContractQuoteRef.php`  [↑ Back to top](#index)

```php
<?php declare(strict_types=1);

namespace Dgp\Sdk\Types\Contract;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;
use Dgp\Sdk\Support\Serialization\Normalizes;

final readonly class ContractQuoteRef implements Arrayable, JsonSerializable
{
    use Normalizes;

    /**
     * @param string|int $id Provider quote id / token
     * @param array<string,mixed>|null $meta
     */
    public function __construct(
        public string|int $id,
        public ?array $meta = null,
    ) {}

    public function toArray(): array
    {
        return $this->normalize([
            'id' => $this->id,
            'meta' => $this->meta,
        ]);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 6


` File: src/Types/Contract/ContractRef.php`  [↑ Back to top](#index)

```php
<?php declare(strict_types=1);

namespace Dgp\Sdk\Types\Contract;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;
use Dgp\Sdk\Support\Serialization\Normalizes;

final readonly class ContractRef implements Arrayable, JsonSerializable
{
    use Normalizes;

    /**
     * @param string|int $id Provider contract id
     * @param array<string,mixed>|null $meta
     */
    public function __construct(
        public string|int $id,
        public ?array $meta = null,
    ) {}

    public function toArray(): array
    {
        return $this->normalize([
            'id' => $this->id,
            'meta' => $this->meta,
        ]);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 7


` File: src/Types/Contract/ContractStatus.php`  [↑ Back to top](#index)

```php
<?php declare(strict_types=1);

namespace Dgp\Sdk\Types\Contract;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;
use Dgp\Sdk\Support\Serialization\Normalizes;

final readonly class ContractStatus implements Arrayable, JsonSerializable
{
    use Normalizes;

    /**
     * @param array<string,mixed>|null $meta
     */
    public function __construct(
        public ContractStatusCode $code,
        public ?string $message = null,          // human-readable hint (optional)
        public ?string $raw_status = null,       // provider status string (optional)
        public ?int $progress = null,            // 0..100 (optional)
        public ?string $updated_at = null,       // ISO string (optional)
        public ?array $meta = null,              // provider extras (bag)
    ) {}

    public function isTerminal(): bool
    {
        return $this->code->isTerminal();
    }

    public function toArray(): array
    {
        return $this->normalize([
            'code' => $this->code->value,
            'message' => $this->message,
            'raw_status' => $this->raw_status,
            'progress' => $this->progress,
            'updated_at' => $this->updated_at,
            'meta' => $this->meta,
        ]);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 8


` File: src/Types/Contract/ContractStatusCode.php`  [↑ Back to top](#index)

```php
<?php declare(strict_types=1);

namespace Dgp\Sdk\Types\Contract;

enum ContractStatusCode: string
{
    case submitted = 'submitted';
    case reviewing = 'reviewing';
    case accepted = 'accepted';
    case rejected = 'rejected';

    case in_progress = 'in_progress';
    case delivered = 'delivered';
    case completed = 'completed';

    case cancelled = 'cancelled';
    case failed = 'failed';

    public function isTerminal(): bool
    {
        return match ($this) {
            self::rejected,
            self::completed,
            self::cancelled,
            self::failed => true,
            default => false,
        };
    }
}
```

---
#### 9


` File: src/Types/Currency.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;

final readonly class Currency implements Arrayable, JsonSerializable
{
    public function __construct(
        public string $code,      // e.g. "USD"
        public int    $decimals = 2,  // 2 for USD, 0 for JPY etc
    )
    {
    }

    public function toArray(): array
    {
        return [
            'code' => $this->code,
            'decimals' => $this->decimals,
        ];
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 10


` File: src/Types/DripFeed/DripFeedRef.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\DripFeed;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;

final readonly class DripFeedRef implements Arrayable, JsonSerializable
{
    /**
     * @param array<string, mixed>|null $meta
     */
    public function __construct(
        public string      $providerDripFeedId,
        public string|int|null $serviceId = null,
        public ?array      $meta = null,
    ) {}

    public function toArray(): array
    {
        return array_filter([
            'provider_dripfeed_id' => $this->providerDripFeedId,
            'service_id' => $this->serviceId,
            'meta' => $this->meta,
        ], static fn ($v) => $v !== null);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 11


` File: src/Types/DripFeed/DripFeedStatus.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\DripFeed;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;

final readonly class DripFeedStatus implements Arrayable, JsonSerializable
{
    /**
     * @param array<string, mixed>|null $meta
     */
    public function __construct(
        public DripFeedStatusCode $code,
        public ?string            $providerStatus = null,
        public ?string            $message = null,
        public ?array             $meta = null,
    ) {}

    public function toArray(): array
    {
        return array_filter([
            'code' => $this->code->value,
            'provider_status' => $this->providerStatus,
            'message' => $this->message,
            'meta' => $this->meta,
        ], static fn ($v) => $v !== null);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 12


` File: src/Types/DripFeed/DripFeedStatusCode.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\DripFeed;

enum DripFeedStatusCode: string
{
    case PENDING   = 'pending';
    case ACTIVE    = 'active';
    case PAUSED    = 'paused';
    case COMPLETED = 'completed';
    case CANCELLED = 'cancelled';
    case FAILED    = 'failed';
    case UNKNOWN   = 'unknown';
}
```

---
#### 13


` File: src/Types/Driver/ConfigField.php`  [↑ Back to top](#index)

```php
<?php declare(strict_types=1);

namespace Dgp\Sdk\Types\Driver;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;
use Dgp\Sdk\Support\Serialization\Normalizes;

final class ConfigField implements Arrayable, JsonSerializable
{
    use Normalizes;

    /**
     * @param list<string>|null $rules
     * @param list<ConfigFieldOption>|null $options
     * @param array<string,mixed>|null $meta
     */
    public function __construct(
        public readonly string  $name,
        public readonly string  $label,
        public readonly ?string $type = null,        // "text"|"password"|"select"|...

        public readonly ?bool   $required = null,
        public readonly ?bool   $secret = null,

        // ✅ NEW: mode scoping (null=both, true=sandbox-only, false=live-only)
        public readonly ?bool   $sandbox = null,

        public readonly ?array  $rules = null,
        public readonly mixed   $default = null,
        public readonly ?string $help_text = null,
        public readonly ?array  $options = null,
        public readonly ?array  $meta = null,
    )
    {
    }

    public function toArray(): array
    {
        return $this->normalize([
            'name' => $this->name,
            'label' => $this->label,
            'type' => $this->type,
            'required' => $this->required,
            'secret' => $this->secret,
            'sandbox' => $this->sandbox, // ✅ include so host UI/storage can scope
            'rules' => $this->rules,
            'default' => $this->default,
            'help_text' => $this->help_text,
            'options' => $this->options,
            'meta' => $this->meta,
        ]);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 14


` File: src/Types/Driver/ConfigFieldOption.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Driver;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;
use Dgp\Sdk\Support\Serialization\Normalizes;

final class ConfigFieldOption implements Arrayable, JsonSerializable
{
    use Normalizes;

    /**
     * @param array<string,mixed>|null $meta
     */
    public function __construct(
        public readonly string               $id,
        public readonly string               $label,
        public readonly string|int|bool|null $value = null,
        public readonly ?bool                $disabled = null,
        public readonly ?array               $meta = null,
    )
    {
    }

    public function toArray(): array
    {
        return $this->normalize([
            'id' => $this->id,
            'label' => $this->label,
            'value' => $this->value,
            'disabled' => $this->disabled,
            'meta' => $this->meta,
        ]);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 15


` File: src/Types/Driver/DriverConfigSchema.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Driver;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;
use Dgp\Sdk\Support\Serialization\Normalizes;

final class DriverConfigSchema implements Arrayable, JsonSerializable
{
    use Normalizes;

    /**
     * @param list<ConfigField> $fields
     * @param array<string,mixed>|null $meta
     */
    public function __construct(
        public readonly array   $fields,
        public readonly ?string $schema_version = null,
        public readonly ?array  $meta = null,
    )
    {
    }

    /** @return list<string> */
    public function keysForSandbox(bool $sandbox): array
    {
        $out = [];

        foreach ($this->fields as $f) {
            if ($f->sandbox === null || $f->sandbox === $sandbox) {
                $out[] = $f->name;
            }
        }

        $out = array_values(array_unique($out));
        sort($out);

        return $out;
    }

    public function toArray(): array
    {
        return $this->normalize([
            'schema_version' => $this->schema_version,
            'fields' => $this->fields,
            'meta' => $this->meta,
        ]);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 16


` File: src/Types/Driver/DriverManifest.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Driver;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;
use Dgp\Sdk\Support\Serialization\Normalizes;

final class DriverManifest implements Arrayable, JsonSerializable
{
    use Normalizes;

    /**
     * @param array<string,bool>|null $lanes
     * @param array<string,bool>|null $features
     * @param array<string,mixed>|null $meta
     */
    public function __construct(
        public readonly string $driver_key,              // stable key Host registers/resolves by
        public readonly string $name,                    // display name
        public readonly ?string $version = null,         // semantic version (optional)
        public readonly ?ProviderInfo $provider = null,  // who/where this provider is

        // minimal lane flags (Host can still verify via instanceof)
        public readonly ?array $lanes = null,            // e.g. ['lane_a' => true, 'lane_b' => false]

        // optional feature flags (cancel/refill/bulk/etc)
        public readonly ?array $features = null,         // e.g. ['refill' => true, 'bulk' => false]

        // optional: driver-level config schema (Host may validate/render)
        public readonly ?DriverConfigSchema $config_schema = null,

        public readonly ?array $meta = null,
    ) {}

    public function toArray(): array
    {
        return $this->normalize([
            'driver_key' => $this->driver_key,
            'name' => $this->name,
            'version' => $this->version,
            'provider' => $this->provider,
            'lanes' => $this->lanes,
            'features' => $this->features,
            'config_schema' => $this->config_schema,
            'meta' => $this->meta,
        ]);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 17


` File: src/Types/Driver/ProviderInfo.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Driver;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;
use Dgp\Sdk\Support\Serialization\Normalizes;

final class ProviderInfo implements Arrayable, JsonSerializable
{
    use Normalizes;

    /**
     * @param array<string,mixed>|null $meta
     */
    public function __construct(
        public readonly ?string $vendor = null,
        public readonly ?string $website = null,
        public readonly ?string $docs = null,
        public readonly ?string $support = null,
        public readonly ?array $meta = null,
    ) {}

    public function toArray(): array
    {
        return $this->normalize([
            'vendor' => $this->vendor,
            'website' => $this->website,
            'docs' => $this->docs,
            'support' => $this->support,
            'meta' => $this->meta,
        ]);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 18


` File: src/Types/Infra/CapabilityMap.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Infra;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;

final readonly class CapabilityMap implements Arrayable, JsonSerializable
{
    /** @param array<string, bool> $map */
    public function __construct(
        public array $map = [],
    )
    {
    }

    public function has(string $capability): bool
    {
        return (bool)($this->map[$capability] ?? false);
    }

    public function with(string $capability, bool $enabled = true): self
    {
        $next = $this->map;
        $next[$capability] = $enabled;
        return new self($next);
    }

    public function toArray(): array
    {
        return $this->map;
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 19


` File: src/Types/Infra/HttpMethod.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Infra;

enum HttpMethod: string
{
    case GET = 'GET';
    case POST = 'POST';
    case PUT = 'PUT';
    case PATCH = 'PATCH';
    case DELETE = 'DELETE';
}
```

---
#### 20


` File: src/Types/Infra/IdempotencyKey.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Infra;

use JsonSerializable;

final readonly class IdempotencyKey implements JsonSerializable
{
    public function __construct(public string $value) {}

    public function jsonSerialize(): array
    {
        return ['value' => $this->value];
    }
}
```

---
#### 21


` File: src/Types/Infra/ProviderRateLimit.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Infra;

use JsonSerializable;

final readonly class ProviderRateLimit implements JsonSerializable
{
    public function __construct(
        public ?int                     $limit = null,
        public ?int                     $remaining = null,
        public ?int                     $retryAfterMs = null,
        public ?ProviderRateLimitWindow $window = null,
    ) {}

    public function jsonSerialize(): array
    {
        return array_filter([
            'limit' => $this->limit,
            'remaining' => $this->remaining,
            'retryAfterMs' => $this->retryAfterMs,
            'window' => $this->window,
        ], static fn ($v) => $v !== null);
    }
}
```

---
#### 22


` File: src/Types/Infra/ProviderRateLimitWindow.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Infra;

use JsonSerializable;

final readonly class ProviderRateLimitWindow implements JsonSerializable
{
    public function __construct(
        public int  $windowMs,
        public ?int $resetAtUnixMs = null,
    ) {}

    public function jsonSerialize(): array
    {
        return array_filter([
            'windowMs' => $this->windowMs,
            'resetAtUnixMs' => $this->resetAtUnixMs,
        ], static fn ($v) => $v !== null);
    }
}
```

---
#### 23


` File: src/Types/Money.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;

final readonly class Money implements Arrayable, JsonSerializable
{
    public function __construct(
        public int      $amountMinor,      // minor units: cents, kobo, etc
        public Currency $currency,
    )
    {
    }

    public function toArray(): array
    {
        return [
            'amount_minor' => $this->amountMinor,
            'currency' => $this->currency->toArray(),
        ];
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 24


` File: src/Types/Ops/AuditRecord.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Ops;

use DateTimeInterface;
use JsonSerializable;
use Dgp\Sdk\Support\DgpError;
use Dgp\Sdk\Support\Serialization\Arrayable;
use Dgp\Sdk\Support\Serialization\Normalizes;
use Dgp\Sdk\Payloads\Requests\Infra\HttpRequestDto;
use Dgp\Sdk\Payloads\Responses\Infra\HttpResponseDto;

final class AuditRecord implements Arrayable, JsonSerializable
{
    use Normalizes;

    public const LEVEL_INFO = 'info';
    public const LEVEL_WARN = 'warn';
    public const LEVEL_ERROR = 'error';

    public const KIND_REQUEST = 'request';
    public const KIND_RESPONSE = 'response';
    public const KIND_WEBHOOK = 'webhook';
    public const KIND_HEALTH = 'health';
    public const KIND_INTERNAL = 'internal';

    /**
     * @param array<string,mixed>|null $context
     * @param array<string,mixed>|null $meta
     */
    public function __construct(
        public readonly string             $operation,                    // e.g. "order.create"
        public readonly string             $kind = self::KIND_INTERNAL,    // request/response/webhook/...
        public readonly string             $level = self::LEVEL_INFO,      // info/warn/error

        public readonly ?DateTimeInterface $at = null,         // when it happened (ISO via Normalizes)
        public readonly ?string            $driverKey = null,             // driver identifier (if known)
        public readonly string|int|null    $serviceId = null,     // optional: provider service id
        public readonly ?string            $providerRef = null,           // optional: provider order/refill id, etc.

        public readonly ?HttpRequestDto    $httpRequest = null,
        public readonly ?HttpResponseDto   $httpResponse = null,

        public readonly array|string|null  $providerPayload = null, // decoded json (array) or raw body (string)
        public readonly ?DgpError          $error = null,                   // normalized error (if any)

        public readonly ?array             $context = null, // safe context (currency, country, account tier...) - redacted
        public readonly ?array             $meta = null,    // safe extras - redacted
    )
    {
    }

    public function toArray(): array
    {
        // NOTE: explicit keys; do not rely on property names for stable external serialization.
        return $this->normalize([
            'operation' => $this->operation,
            'kind' => $this->kind,
            'level' => $this->level,

            'at' => $this->at,
            'driver_key' => $this->driverKey,
            'service_id' => $this->serviceId,
            'provider_ref' => $this->providerRef,

            'http_request' => $this->httpRequest,
            'http_response' => $this->httpResponse,

            'provider_payload' => $this->providerPayload,
            'error' => $this->error,

            'context' => $this->context,
            'meta' => $this->meta,
        ]);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 25


` File: src/Types/Ops/HealthState.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Ops;

enum HealthState: string
{
    case OK = 'ok';
    case DEGRADED = 'degraded';
    case DOWN = 'down';
    case UNKNOWN = 'unknown';
}
```

---
#### 26


` File: src/Types/Ops/WebhookEvent.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Ops;

use JsonSerializable;

final readonly class WebhookEvent implements JsonSerializable
{
    /**
     * @param array<string,mixed>|null $data
     * @param array<string,mixed>|null $meta
     */
    public function __construct(
        public string  $type,
        public ?string $providerEventId = null,
        public ?int    $occurredAtUnixMs = null,
        public ?array  $data = null,
        public ?array  $meta = null,
    ) {}

    public function jsonSerialize(): array
    {
        return array_filter([
            'type' => $this->type,
            'providerEventId' => $this->providerEventId,
            'occurredAtUnixMs' => $this->occurredAtUnixMs,
            'data' => $this->data,
            'meta' => $this->meta,
        ], static fn ($v) => $v !== null);
    }
}
```

---
#### 27


` File: src/Types/Ops/WebhookEventType.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Ops;

final class WebhookEventType
{
    public const ORDER_STATUS = 'order.status';
    public const REFILL_STATUS = 'refill.status';
    public const BALANCE = 'balance';

    private function __construct() {}
}
```

---
#### 28


` File: src/Types/Orders/OrderRef.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Orders;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;

final readonly class OrderRef implements Arrayable, JsonSerializable
{
    /**
     * @param array<string, mixed>|null $meta
     */
    public function __construct(
        public string  $providerOrderId,
        public ?string $clientOrderRef = null, // host-side idempotency/reference
        public ?array  $meta = null,
    )
    {
    }

    public function toArray(): array
    {
        return array_filter([
            'provider_order_id' => $this->providerOrderId,
            'client_order_ref' => $this->clientOrderRef,
            'meta' => $this->meta,
        ], static fn($v) => $v !== null);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 29


` File: src/Types/Orders/OrderStatus.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Orders;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;

final readonly class OrderStatus implements Arrayable, JsonSerializable
{
    /**
     * @param array<string, mixed>|null $meta
     */
    public function __construct(
        public OrderStatusCode $code,
        public ?string         $providerStatus = null, // raw provider status text if any
        public ?int            $startCount = null,
        public ?int            $remains = null,
        public ?string         $message = null,
        public ?array          $meta = null,
    )
    {
    }

    public function toArray(): array
    {
        return array_filter([
            'code' => $this->code->value,
            'provider_status' => $this->providerStatus,
            'start_count' => $this->startCount,
            'remains' => $this->remains,
            'message' => $this->message,
            'meta' => $this->meta,
        ], static fn($v) => $v !== null);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 30


` File: src/Types/Orders/OrderStatusCode.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Orders;

enum OrderStatusCode: string
{
    case PENDING = 'pending';
    case PROCESSING = 'processing';
    case IN_PROGRESS = 'in_progress';
    case PARTIAL = 'partial';
    case COMPLETED = 'completed';

    case CANCELED = 'canceled';
    case REFUNDED = 'refunded';
    case FAILED = 'failed';

    case UNKNOWN = 'unknown';
}
```

---
#### 31


` File: src/Types/Refill/RefillRef.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Refill;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;

final class RefillRef implements Arrayable, JsonSerializable
{
    /**
     * @param array<string, mixed>|null $meta
     */
    public function __construct(
        public readonly string $providerRefillId,
        public readonly string $providerOrderId,
        public readonly ?array $meta = null,
    ) {}

    public function toArray(): array
    {
        return array_filter([
            'provider_refill_id' => $this->providerRefillId,
            'provider_order_id' => $this->providerOrderId,
            'meta' => $this->meta,
        ], static fn ($v) => $v !== null);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 32


` File: src/Types/Refill/RefillStatus.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Refill;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;

final readonly class RefillStatus implements Arrayable, JsonSerializable
{
    /**
     * @param array<string, mixed>|null $meta
     */
    public function __construct(
        public RefillStatusCode $code,
        public ?string          $providerStatus = null,
        public ?string          $message = null,
        public ?array           $meta = null,
    ) {}

    public function toArray(): array
    {
        return array_filter([
            'code' => $this->code->value,
            'provider_status' => $this->providerStatus,
            'message' => $this->message,
            'meta' => $this->meta,
        ], static fn ($v) => $v !== null);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 33


` File: src/Types/Refill/RefillStatusCode.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Refill;

enum RefillStatusCode: string
{
    case PENDING = 'pending';
    case PROCESSING = 'processing';
    case IN_PROGRESS = 'in_progress';
    case COMPLETED = 'completed';

    case REJECTED = 'rejected';
    case FAILED = 'failed';

    case UNKNOWN = 'unknown';
}
```

---
#### 34


` File: src/Types/Schema/ConstraintOverride.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Schema;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;

final readonly class ConstraintOverride implements Arrayable, JsonSerializable
{
    public function __construct(
        public bool   $from,
        public bool   $to,
        public string $origin, // tagId
    ) {}

    public function toArray(): array
    {
        return [
            'from' => $this->from,
            'to' => $this->to,
            'origin' => $this->origin,
        ];
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 35


` File: src/Types/Schema/Field.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Schema;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;
use Dgp\Sdk\Types\Schema\Ui\UiNode;

final readonly class Field implements Arrayable, JsonSerializable
{
    /**
     * @param array<string, UiNode>|null $ui
     * @param array<string, mixed>|null $defaults
     * @param FieldOption[]|null $options
     * @param array<string, mixed>|null $meta
     */
    public function __construct(
        public string            $id,
        public string            $type,                 // "custom" | string
        public string            $label,

        public ?string           $name = null,
        public ?bool             $required = null,

        public ?array            $ui = null,
        public ?array            $defaults = null,

        public string|array|null $bindId = null,
        public ?array            $options = null,

        public ?string           $component = null,    // required if type === "custom"
        public ?string           $pricingRole = null,  // "base" | "utility" (JSON key: pricing_role)
        public ?array            $meta = null,

        public ?bool             $button = null,
        public ?int              $serviceId = null,
    ) {}

    public function toArray(): array
    {
        $uiOut = null;
        if ($this->ui !== null) {
            $uiOut = [];
            foreach ($this->ui as $k => $v) {
                $uiOut[$k] = $v->toArray();
            }
        }

        $optOut = null;
        if ($this->options !== null) {
            $optOut = array_map(static fn (FieldOption $o) => $o->toArray(), $this->options);
        }

        return array_filter([
            'id' => $this->id,
            'type' => $this->type,
            'label' => $this->label,

            'name' => $this->name,
            'required' => $this->required,

            'ui' => $uiOut,
            'defaults' => $this->defaults,

            'bind_id' => $this->bindId,
            'options' => $optOut,

            'component' => $this->component,
            'pricing_role' => $this->pricingRole, // snake_case key enforced
            'meta' => $this->meta,                // must preserve mixed meta keys

            'button' => $this->button,
            'service_id' => $this->serviceId,
        ], static fn ($v) => $v !== null);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 36


` File: src/Types/Schema/FieldOption.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Schema;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;

final readonly class FieldOption implements Arrayable, JsonSerializable
{
    /**
     * @param array<string, mixed>|null $meta
     */
    public function __construct(
        public string          $id,
        public string          $label,
        public string|int|null $value = null,
        public ?int            $serviceId = null,
        public ?string         $pricingRole = null, // "base" | "utility"
        public ?array          $meta = null,
    ) {}

    public function toArray(): array
    {
        return array_filter([
            'id' => $this->id,
            'label' => $this->label,
            'value' => $this->value,
            'service_id' => $this->serviceId,
            'pricing_role' => $this->pricingRole,
            'meta' => $this->meta, // must preserve mixed key style (e.g. quantityDefault)
        ], static fn ($v) => $v !== null);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 37


` File: src/Types/Schema/FlagKey.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Schema;

enum FlagKey: string
{
    case REFILL = 'refill';
    case CANCEL = 'cancel';
    case DRIPFEED = 'dripfeed';
}
```

---
#### 38


` File: src/Types/Schema/ServiceFallback.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Schema;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;

final readonly class ServiceFallback implements Arrayable, JsonSerializable
{
    /**
     * nodes: NodeIdRef(string) -> ServiceIdRef(list)
     * global: ServiceIdRef(string|int as key) -> ServiceIdRef(list)
     *
     * @param array<string, array<int, int|string>>|null $nodes
     * @param array<string, array<int, int|string>>|null $global
     */
    public function __construct(
        public ?array $nodes = null,
        public ?array $global = null,
    ) {}

    public function toArray(): array
    {
        return array_filter([
            'nodes' => $this->nodes,
            'global' => $this->global,
        ], static fn ($v) => $v !== null);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 39


` File: src/Types/Schema/ServiceProps.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Schema;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;

final readonly class ServiceProps implements Arrayable, JsonSerializable
{
    /**
     * @param array<string, string[]>|null $orderForTags
     * @param Tag[] $filters
     * @param Field[] $fields
     * @param array<string, string[]>|null $includesForButtons
     * @param array<string, string[]>|null $excludesForButtons
     */
    public function __construct(
        public array            $filters,
        public array            $fields,

        public ?array           $orderForTags = null,
        public ?array           $includesForButtons = null,
        public ?array           $excludesForButtons = null,

        public ?string          $schemaVersion = null,
        public ?ServiceFallback $fallbacks = null,
    ) {}

    public function toArray(): array
    {
        return array_filter([
            'order_for_tags' => $this->orderForTags,
            'filters' => array_map(static fn (Tag $t) => $t->toArray(), $this->filters),
            'fields' => array_map(static fn (Field $f) => $f->toArray(), $this->fields),
            'includes_for_buttons' => $this->includesForButtons,
            'excludes_for_buttons' => $this->excludesForButtons,
            'schema_version' => $this->schemaVersion,
            'fallbacks' => $this->fallbacks?->toArray(),
        ], static fn ($v) => $v !== null);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 40


` File: src/Types/Schema/Tag.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Schema;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;

final readonly class Tag implements Arrayable, JsonSerializable
{
    /**
     * @param string[]|null $includes
     * @param string[]|null $excludes
     * @param array<string, mixed>|null $meta
     * @param array<string, bool>|null $constraints
     * @param array<string, string>|null $constraintsOrigin
     * @param array<string, ConstraintOverride>|null $constraintsOverrides
     */
    public function __construct(
        public string  $id,
        public string  $label,
        public ?string $bindId = null,
        public ?int    $serviceId = null,

        public ?array  $includes = null,
        public ?array  $excludes = null,

        public ?array  $meta = null,

        public ?array  $constraints = null,
        public ?array  $constraintsOrigin = null,
        public ?array  $constraintsOverrides = null,
    ) {}

    public function toArray(): array
    {
        $overrides = null;
        if ($this->constraintsOverrides !== null) {
            $overrides = [];
            foreach ($this->constraintsOverrides as $k => $v) {
                $overrides[$k] = $v->toArray();
            }
        }

        return array_filter([
            'id' => $this->id,
            'label' => $this->label,
            'bind_id' => $this->bindId,
            'service_id' => $this->serviceId,
            'includes' => $this->includes,
            'excludes' => $this->excludes,
            'meta' => $this->meta,
            'constraints' => $this->constraints,
            'constraints_origin' => $this->constraintsOrigin,
            'constraints_overrides' => $overrides,
        ], static fn ($v) => $v !== null);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 41


` File: src/Types/Schema/Ui/UiAnyOf.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Schema\Ui;

final readonly class UiAnyOf implements UiNode
{
    /**
     * @param array<int, array{type: 'string'|'number'|'boolean', value: string|int|float|bool, title?: string, description?: string}> $items
     */
    public function __construct(
        public array $items,
        public ?bool $multiple = null,
    ) {}

    public function getType(): string { return 'anyOf'; }

    public function toArray(): array
    {
        return array_filter([
            'type' => $this->getType(),
            'multiple' => $this->multiple,
            'items' => $this->items,
        ], static fn ($v) => $v !== null);
    }

    public function jsonSerialize(): array { return $this->toArray(); }
}
```

---
#### 42


` File: src/Types/Schema/Ui/UiArray.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Schema\Ui;

final readonly class UiArray implements UiNode
{
    /**
     * @param UiNode[]|null $items
     */
    public function __construct(
        public ?UiNode $item = null,
        public ?array  $items = null,
        public ?int    $minItems = null,
        public ?int    $maxItems = null,
        public ?bool   $uniqueItems = null,
    ) {}

    public function getType(): string { return 'array'; }

    public function toArray(): array
    {
        $tuple = null;
        if ($this->items !== null) {
            $tuple = array_map(static fn (UiNode $n) => $n->toArray(), $this->items);
        }

        return array_filter([
            'type' => $this->getType(),
            'item' => $this->item?->toArray(),
            'items' => $tuple,
            'minItems' => $this->minItems,
            'maxItems' => $this->maxItems,
            'uniqueItems' => $this->uniqueItems,
        ], static fn ($v) => $v !== null);
    }

    public function jsonSerialize(): array { return $this->toArray(); }
}
```

---
#### 43


` File: src/Types/Schema/Ui/UiBoolean.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Schema\Ui;

final class UiBoolean implements UiNode
{
    public function getType(): string { return 'boolean'; }

    public function toArray(): array
    {
        return ['type' => $this->getType()];
    }

    public function jsonSerialize(): array { return $this->toArray(); }
}
```

---
#### 44


` File: src/Types/Schema/Ui/UiNode.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Schema\Ui;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;

interface UiNode extends Arrayable, JsonSerializable
{
    public function getType(): string;
}
```

---
#### 45


` File: src/Types/Schema/Ui/UiNumber.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Schema\Ui;

final readonly class UiNumber implements UiNode
{
    public function __construct(
        public ?float $minimum = null,
        public ?float $maximum = null,
        public ?float $multipleOf = null,
    ) {}

    public function getType(): string { return 'number'; }

    public function toArray(): array
    {
        return array_filter([
            'type' => $this->getType(),
            'minimum' => $this->minimum,
            'maximum' => $this->maximum,
            'multipleOf' => $this->multipleOf,
        ], static fn ($v) => $v !== null);
    }

    public function jsonSerialize(): array { return $this->toArray(); }
}
```

---
#### 46


` File: src/Types/Schema/Ui/UiObject.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Schema\Ui;

final readonly class UiObject implements UiNode
{
    /**
     * @param array<string, UiNode> $fields
     * @param string[]|null $required
     * @param string[]|null $order
     */
    public function __construct(
        public array  $fields,
        public ?array $required = null,
        public ?array $order = null,
    ) {}

    public function getType(): string { return 'object'; }

    public function toArray(): array
    {
        $outFields = [];
        foreach ($this->fields as $k => $v) {
            $outFields[$k] = $v->toArray();
        }

        return array_filter([
            'type' => $this->getType(),
            'fields' => $outFields,
            'required' => $this->required,
            'order' => $this->order,
        ], static fn ($v) => $v !== null);
    }

    public function jsonSerialize(): array { return $this->toArray(); }
}
```

---
#### 47


` File: src/Types/Schema/Ui/UiString.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Schema\Ui;

final readonly class UiString implements UiNode
{
    /**
     * @param string[]|null $enum
     */
    public function __construct(
        public ?array  $enum = null,
        public ?int    $minLength = null,
        public ?int    $maxLength = null,
        public ?string $pattern = null,
        public ?string $format = null,
    ) {}

    public function getType(): string { return 'string'; }

    public function toArray(): array
    {
        return array_filter([
            'type' => $this->getType(),
            'enum' => $this->enum,
            'minLength' => $this->minLength,
            'maxLength' => $this->maxLength,
            'pattern' => $this->pattern,
            'format' => $this->format,
        ], static fn ($v) => $v !== null);
    }

    public function jsonSerialize(): array { return $this->toArray(); }
}
```

---
#### 48


` File: src/Types/Service/OperationKey.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Service;

final class OperationKey
{
    // Catalog / schema
    public const CATALOG_LIST_SERVICES = 'catalog.services.list';

    // Orders
    public const ORDER_CREATE = 'order.create';
    public const ORDER_STATUS = 'order.status';
    public const ORDER_CANCEL = 'order.cancel';

    // Balance
    public const BALANCE_GET = 'balance.get';

    // Refill
    public const REFILL_CREATE = 'refill.create';
    public const REFILL_STATUS = 'refill.status';

    // Bulk
    public const BULK_ORDER_CREATE = 'bulk.orders.create';
    public const BULK_ORDER_STATUS = 'bulk.orders.status';

    // Subscription
    public const SUBSCRIPTION_CREATE = 'subscription.create';
    public const SUBSCRIPTION_STATUS = 'subscription.status';
    public const SUBSCRIPTION_CANCEL = 'subscription.cancel';

    // DripFeed
    public const DRIPFEED_CREATE = 'dripfeed.create';
    public const DRIPFEED_STATUS = 'dripfeed.status';
    public const DRIPFEED_CANCEL = 'dripfeed.cancel';

    private function __construct()
    {
    }
}
```

---
#### 49


` File: src/Types/Service/ServiceDefinition.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Service;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;

final readonly class ServiceDefinition implements Arrayable, JsonSerializable
{
    /**
     * @param array<string, mixed>|null $meta
     */
    public function __construct(
        public string            $id,          // provider service id
        public string            $name,
        public float             $rate,         // keep as float for now (provider-centric); host can convert to Money
        public int               $min,
        public int               $max,
        public string            $category,
        public ?ServiceFlagset   $flags = new ServiceFlagset([], true),

        public ?ServiceEstimates $estimates = null,

        public ?array            $meta = null, // provider extras (bag)
    )
    {
    }

    public function toArray(): array
    {
        return array_filter([
            'id' => $this->id,
            'name' => $this->name,
            'rate' => $this->rate,
            'min' => $this->min,
            'max' => $this->max,
            'category' => $this->category,
            'flags' => $this->flags?->toArray(),
            'estimates' => $this->estimates?->toArray(),
            'meta' => $this->meta,
        ], static fn($v) => $v !== null);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 50


` File: src/Types/Service/ServiceEstimates.php`  [↑ Back to top](#index)

```php
<?php declare(strict_types=1);

namespace Dgp\Sdk\Types\Service;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;
use Dgp\Sdk\Support\Serialization\Normalizes;

final readonly class ServiceEstimates implements Arrayable, JsonSerializable
{
    use Normalizes;

    /**
     * @param array<string,mixed>|null $meta
     */
    public function __construct(
        public ?TimeRangeEstimate $start = null,
        public ?SpeedEstimate $speed = null,
        public ?TimeRangeEstimate $average = null,
        public ?array $meta = null,
    ) {}

    public function toArray(): array
    {
        return $this->normalize([
            'start' => $this->start,
            'speed' => $this->speed,
            'average' => $this->average,
            'meta' => $this->meta,
        ]);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 51


` File: src/Types/Service/ServiceField.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Service;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;

final readonly class ServiceField implements Arrayable, JsonSerializable
{
    /**
     * @param ServiceFieldRule[] $rules
     * @param array<string, mixed>|null $meta
     */
    public function __construct(
        public string $key,      // e.g. "link", "quantity", "username"
        public string $label,
        public string $type,     // e.g. "string", "number", "text", "url"
        public bool   $required = false,
        public array  $rules = [],
        public ?array $meta = null,
    ) {}

    public function toArray(): array
    {
        return array_filter([
            'key' => $this->key,
            'label' => $this->label,
            'type' => $this->type,
            'required' => $this->required,
            'rules' => array_map(static fn (ServiceFieldRule $r) => $r->toArray(), $this->rules),
            'meta' => $this->meta,
        ], static fn ($v) => $v !== null);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 52


` File: src/Types/Service/ServiceFieldRule.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Service;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;

final readonly class ServiceFieldRule implements Arrayable, JsonSerializable
{
    /**
     * @param string $rule
     * @param mixed $value
     */
    public function __construct(
        public string $rule,   // e.g. "required", "url", "min", "max", "regex"
        public mixed  $value = true,
    )
    {
    }

    public function toArray(): array
    {
        return [
            'rule' => $this->rule,
            'value' => $this->value,
        ];
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 53


` File: src/Types/Service/ServiceFlag.php`  [↑ Back to top](#index)

```php
<?php declare(strict_types=1);

namespace Dgp\Sdk\Types\Service;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;

final readonly class ServiceFlag implements Arrayable, JsonSerializable
{
    /**
     * @param array<string,mixed>|null $meta
     */
    public function __construct(
        public string $id,                // e.g. "refill", "cancel", "dripfeed"
        public bool   $enabled,
        public string $description,        // MUST (UI + docs)
        public ?array $meta = null,        // flag-specific extras (bag)
    )
    {
    }

    public function toArray(): array
    {
        return array_filter([
            'id' => $this->id,
            'enabled' => $this->enabled,
            'description' => $this->description,
            'meta' => $this->meta,
        ], static fn($v) => $v !== null);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 54


` File: src/Types/Service/ServiceFlagset.php`  [↑ Back to top](#index)

```php
<?php /** @noinspection SpellCheckingInspection */
declare(strict_types=1);

namespace Dgp\Sdk\Types\Service;

use InvalidArgumentException;
use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;

final readonly class ServiceFlagset implements Arrayable, JsonSerializable
{
    /** @var array<string,ServiceFlag> */
    public array $flags;

    /**
     * @param array<string,ServiceFlag> $flags Map: flagId => ServiceFlag
     */
    public function __construct(array $flags = [], bool $withDefaults = false)
    {
        $normalized = [];

        if($withDefaults) {
            $flags = array_merge($flags, self::defaults()->flags);
        }

        foreach ($flags as $flag) {
            if (!$flag instanceof ServiceFlag) {
                throw new InvalidArgumentException('ServiceFlagset expects values of type ServiceFlag.');
            }

            // canonicalize key from the flag id (prevents mismatched keys)
            $normalized[$flag->id] = $flag;
        }

        $this->flags = $normalized;
    }

    public function withDefaults(bool $refill = false, bool $cancel = false, bool $dripfeed = false, bool $contract = false): self
    {
        return self::defaults($refill, $cancel, $dripfeed, $contract);
    }

    public static function defaults(bool $refill = false, bool $cancel = false, bool $dripfeed = false, bool $contract = false): self
    {
        return new self([
            new ServiceFlag(
                id: 'refill',
                enabled: $refill,
                description: 'Service supports refill after completion (if provider allows).',
            ),
            new ServiceFlag(
                id: 'cancel',
                enabled: $cancel,
                description: 'Service supports cancellation (if provider allows).',
            ),
            new ServiceFlag(
                id: 'dripfeed',
                enabled: $dripfeed,
                description: 'Service supports drip-feed delivery (if provider allows).',
            ),
            new ServiceFlag(
                id: 'contract',
                enabled: $contract,
                description: 'Service is a contract-type service (handled via contract flow/contract rules).',
            ),
        ]);
    }

    public function get(string $id): ?ServiceFlag
    {
        return $this->flags[$id] ?? null;
    }

    public function enabled(string $id, bool $default = false): bool
    {
        return $this->flags[$id]->enabled ?? $default;
    }

    public function with(ServiceFlag $flag): self
    {
        $next = $this->flags;
        $next[$flag->id] = $flag;
        return new self($next);
    }

    /** @return array<string,array<string,mixed>> */
    public function toArray(): array
    {
        return array_map(static function ($flag) {
            return $flag->toArray();
        }, $this->flags);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 55


` File: src/Types/Service/ServiceInputSchema.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Service;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;

final readonly class ServiceInputSchema implements Arrayable, JsonSerializable
{
    /**
     * @param ServiceField[] $fields
     * @param array<string, mixed>|null $meta
     */
    public function __construct(
        public string $serviceId,  // provider service id
        public array  $fields = [],
        public ?array $meta = null,
    )
    {
    }

    public function toArray(): array
    {
        return array_filter([
            'service_id' => $this->serviceId,
            'fields' => array_map(static fn(ServiceField $f) => $f->toArray(), $this->fields),
            'meta' => $this->meta,
        ], static fn($v) => $v !== null);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 56


` File: src/Types/Service/SpeedEstimate.php`  [↑ Back to top](#index)

```php
<?php declare(strict_types=1);

namespace Dgp\Sdk\Types\Service;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;
use Dgp\Sdk\Support\Serialization\Normalizes;

final readonly class SpeedEstimate implements Arrayable, JsonSerializable
{
    use Normalizes;

    /**
     * @param float $amount Throughput amount (e.g. 500)
     * @param string $per Unit window (e.g. "minute"|"hour"|"day"|"week"|"month")
     * @param string $unit What the amount refers to (e.g. "followers", "likes", "units") (optional)
     * @param string|null $label Human hint (e.g. "500/day", "fast", "slow")
     * @param array<string,mixed>|null $meta
     */
    public function __construct(
        public float  $amount,
        public string $per,
        public string $unit,
        public ?string $label = null,
        public ?array  $meta = null,
    )
    {
    }

    public function toArray(): array
    {
        return $this->normalize([
            'amount' => $this->amount,
            'per' => $this->per,
            'unit' => $this->unit,
            'label' => $this->label,
            'meta' => $this->meta,
        ]);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 57


` File: src/Types/Service/TimeRangeEstimate.php`  [↑ Back to top](#index)

```php
<?php declare(strict_types=1);

namespace Dgp\Sdk\Types\Service;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;
use Dgp\Sdk\Support\Serialization\Normalizes;

final readonly class TimeRangeEstimate implements Arrayable, JsonSerializable
{
    use Normalizes;

    /**
     * @param int $min_seconds Minimum estimate in seconds (machine)
     * @param int $max_seconds Maximum estimate in seconds (machine)
     * @param string|null $label Human hint (e.g. "instant", "5-30 mins", "1-2 hrs")
     * @param array<string,mixed>|null $meta
     */
    public function __construct(
        public int     $min_seconds,
        public int     $max_seconds,
        public ?string $label = null,
        public ?array  $meta = null,
    )
    {
    }

    public function toArray(): array
    {
        return $this->normalize([
            'min_seconds' => $this->min_seconds,
            'max_seconds' => $this->max_seconds,
            'label' => $this->label,
            'meta' => $this->meta,
        ]);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 58


` File: src/Types/Subscription/SubscriptionRef.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Subscription;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;

final readonly class SubscriptionRef implements Arrayable, JsonSerializable
{
    /**
     * @param array<string, mixed>|null $meta
     */
    public function __construct(
        public string      $providerSubscriptionId,
        public string|int|null $serviceId = null,
        public ?array      $meta = null,
    ) {}

    public function toArray(): array
    {
        return array_filter([
            'provider_subscription_id' => $this->providerSubscriptionId,
            'service_id' => $this->serviceId,
            'meta' => $this->meta,
        ], static fn ($v) => $v !== null);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 59


` File: src/Types/Subscription/SubscriptionStatus.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Subscription;

use JsonSerializable;
use Dgp\Sdk\Support\Serialization\Arrayable;

final readonly class SubscriptionStatus implements Arrayable, JsonSerializable
{
    /**
     * @param array<string, mixed>|null $meta
     */
    public function __construct(
        public SubscriptionStatusCode $code,
        public ?string                $providerStatus = null,
        public ?string                $message = null,
        public ?array                 $meta = null,
    )
    {
    }

    public function toArray(): array
    {
        return array_filter([
            'code' => $this->code->value,
            'provider_status' => $this->providerStatus,
            'message' => $this->message,
            'meta' => $this->meta,
        ], static fn($v) => $v !== null);
    }

    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
```

---
#### 60


` File: src/Types/Subscription/SubscriptionStatusCode.php`  [↑ Back to top](#index)

```php
<?php
declare(strict_types=1);

namespace Dgp\Sdk\Types\Subscription;

enum SubscriptionStatusCode: string
{
    case PENDING   = 'pending';
    case ACTIVE    = 'active';
    case PAUSED    = 'paused';
    case COMPLETED = 'completed';
    case CANCELLED = 'cancelled';
    case FAILED    = 'failed';
    case UNKNOWN   = 'unknown';
}
```


---
*Generated with [Prodex](https://github.com/emxhive/prodex) — Codebase decoded.*
<!-- PRODEx v1.4.11 | 2026-01-25T02:30:48.802Z -->